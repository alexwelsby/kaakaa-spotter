import{j as e,L as x,r as o,B as O,R as D,a as j,c as F}from"./vendor-ElVX2CyF.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))l(s);new MutationObserver(s=>{for(const t of s)if(t.type==="childList")for(const a of t.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&l(a)}).observe(document,{childList:!0,subtree:!0});function p(s){const t={};return s.integrity&&(t.integrity=s.integrity),s.referrerPolicy&&(t.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?t.credentials="include":s.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function l(s){if(s.ep)return;s.ep=!0;const t=p(s);fetch(s.href,t)}})();const H="/static/react/react-CHdo91hT.svg",B="_navBar_nm2ek_1",M="_logoHeader_nm2ek_15",q="_pageOptions_nm2ek_41",w={navBar:B,logoHeader:M,pageOptions:q};function R(){return e.jsxs("header",{className:w.logoHeader,children:[e.jsx("img",{src:H}),e.jsxs("h2",{children:["DSA ",e.jsx("br",{}),"Membership",e.jsx("br",{}),"Visualizer"]})]})}function T(){return e.jsxs("nav",{className:w.navBar,children:[e.jsx(R,{}),e.jsxs("div",{className:w.pageOptions,children:[e.jsx(x,{to:"/app",children:"Dashboard"}),e.jsx(x,{to:"/app/stats",children:"Statistics"}),e.jsx(x,{to:"/app/upload",children:"Upload images"}),e.jsx(x,{to:"/app/search",children:"Search via image"})]})]})}const $="_half_1m39z_1",A="_previewImg_1m39z_29",E="_container_1m39z_37",z="_customUpload_1m39z_57",W="_whole_1m39z_85",h={half:$,previewImg:A,container:E,customUpload:z,whole:W};function G(){const[i,n]=o.useState(null),[p,l]=o.useState(null),[s,t]=o.useState([]),[a,b]=o.useState(null),[_,g]=o.useState(!0),[c,f]=o.useState(!1),[S,N]=o.useState(""),P=d=>{setMessage(d.target.value)},U=d=>{f(!c),c||N("")},I=d=>{const r=Array.from(d.target.files),u=URL.createObjectURL(r[0]);n(u),l(r[0])},L=async d=>{d.preventDefault();const r=new FormData;r.append("image",p),r.append("label",S);const u=window.location.pathname,C=u.endsWith("/search")?"http://127.0.0.1:8000/api/search/":u.endsWith("/upload")?"http://127.0.0.1:8000/api/upload/":"";console.log(u),console.log(r);try{const v=await(await fetch(C,{method:"POST",body:r})).json();u.endsWith("/upload")&&t(v.mask_urls),b(v),console.log("data ",v),console.log("maskUrls ",s),g(!1)}catch(y){console.error("Failed to send/fetch to upload api ",y)}};return e.jsx("form",{onSubmit:L,children:e.jsxs("div",{className:h.container,children:[e.jsxs("label",{className:h.customUpload,children:[i?e.jsx("img",{src:i,alt:"Preview"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{style:h.icon,children:"☁️"}),e.jsx("div",{style:h.labelText,children:"Upload an image"})]}),e.jsx("input",{type:"file",accept:"image/*",id:"file-input",name:"filename",onChange:I})]}),e.jsxs("div",{className:h.BandCheck,children:[e.jsx("label",{for:"toggle_label",children:"Do you know the bands for this bird?"}),e.jsx("input",{type:"checkbox",name:"toggle_label",onChange:U}),c?e.jsxs(e.Fragment,{children:[e.jsx("label",{for:"b_label",children:"Band code:"}),e.jsx("input",{type:"text",id:"b_label",name:"b_label",onChange:P})]}):e.jsx(e.Fragment,{})," "]}),_?e.jsx("p",{}):s===void 0||s.length==0?a===void 0?e.jsx("p",{children:"Loading bird prediction..."}):a[0].new_bird_flag==!1?e.jsxs("p",{children:["I think this bird may be ",a[0].winner,"!"," ",a[0].count," of the image vector's nearest neighbors had this label. The median distance of its k-neighbors was greater than 0.8 using cosine similarity, suggesting this image represents a known bird."]}):e.jsxs("p",{children:["I think this may be a new bird... ",a[0].count," of the image vector's nearest neighbors had the label"," ",a[0].winner,". The median distance of its k-neighbors was greater than 0.8, suggesting this is a bird I haven't seen before."]}):e.jsx(e.Fragment,{children:s.map((d,r)=>e.jsx("img",{src:d,alt:`mask-${r}`},r))}),e.jsx("img",{className:h.previewImg}),e.jsx("input",{type:"submit"})]})})}const K="_indivPost_wqkgm_1",V="_dashboard_wqkgm_19",J="_postContent_wqkgm_31",Q="_postImg_wqkgm_41",X="_postHeader_wqkgm_51",m={indivPost:K,dashboard:V,postContent:J,postImg:Q,postHeader:X};function Y(){return e.jsxs("div",{className:h.half,children:[e.jsx("div",{className:m.postHeader,children:"Upload section"}),e.jsx(G,{})]})}function k(){return e.jsx("div",{className:h.whole,children:e.jsx(Y,{})})}function Z({key:i,post:n}){Math.floor((Date.now()-n.date)/1e3);const[p,l]=o.useState(n.original);function s(t){const a=t-Date.now(),b=Math.floor(Math.abs(a)/1e3),_=[{label:"year",seconds:31536e3},{label:"month",seconds:2592e3},{label:"day",seconds:86400},{label:"hour",seconds:3600},{label:"minute",seconds:60},{label:"second",seconds:1}];for(const g of _){const c=Math.floor(b/g.seconds);if(c>=1){const f=g.label+(c>1?"s":"");return a<0?`${c} ${f} ago`:`in ${c} ${f}`}}return"just now"}return e.jsxs("div",{className:m.indivPost,children:[e.jsxs("div",{className:m.postHeader,children:["Uploaded ",s(n.date)]}),e.jsxs("div",{className:m.postContent,children:[e.jsx("button",{onClick:()=>l(n.original),children:"Original"}),n.masks.map((t,a)=>e.jsxs("button",{onClick:()=>l(t),children:["Mask ",a]})),e.jsx("img",{className:m.postImg,src:p})]})]})}function ee(){const[i,n]=o.useState([]),[p,l]=o.useState(!0);return o.useEffect(()=>{async function s(){try{const t=await fetch("http://127.0.0.1:8000/api/images-library");if(!t.ok)throw new Error("Failed to fetch posts");const a=await t.json();n(a)}catch(t){console.error(t)}finally{l(!1)}}s()},[]),p?e.jsx(e.Fragment,{}):e.jsx("div",{className:m.dashboard,children:i.map((s,t)=>e.jsx(Z,{post:s},t))})}const se="_defaultPage_qrynq_1",te={defaultPage:se};function ae({children:i}){return e.jsx("div",{className:te.defaultPage,children:i})}function ne(){return e.jsx(ae,{children:"SSTATS lol. lmao even"})}function oe(){const[i,n]=o.useState(0);return e.jsxs(O,{children:[e.jsx(T,{}),e.jsxs(D,{children:[e.jsx(j,{path:"*",element:e.jsx(ee,{})}),e.jsx(j,{path:"app/upload",element:e.jsx(k,{})}),e.jsx(j,{path:"app/search",element:e.jsx(k,{})}),e.jsx(j,{path:"app/stats",element:e.jsx(ne,{})})]})]})}F.createRoot(document.getElementById("root")).render(e.jsx(o.StrictMode,{children:e.jsx(oe,{})}));
