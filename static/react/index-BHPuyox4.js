import{j as e,L as I,r as a,B,R as M,a as U,c as A}from"./vendor-ElVX2CyF.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))c(s);new MutationObserver(s=>{for(const t of s)if(t.type==="childList")for(const n of t.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&c(n)}).observe(document,{childList:!0,subtree:!0});function m(s){const t={};return s.integrity&&(t.integrity=s.integrity),s.referrerPolicy&&(t.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?t.credentials="include":s.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function c(s){if(s.ep)return;s.ep=!0;const t=m(s);fetch(s.href,t)}})();const H="/static/react/react-CHdo91hT.svg",R="_navBar_nm2ek_1",E="_logoHeader_nm2ek_15",q="_pageOptions_nm2ek_41",P={navBar:R,logoHeader:E,pageOptions:q};function $(){return e.jsxs("header",{className:P.logoHeader,children:[e.jsx("img",{src:H}),e.jsxs("h2",{children:["DSA ",e.jsx("br",{}),"Membership",e.jsx("br",{}),"Visualizer"]})]})}function z(){return e.jsxs("nav",{className:P.navBar,children:[e.jsx($,{}),e.jsxs("div",{className:P.pageOptions,children:[e.jsx(I,{to:"/app",children:"Dashboard"}),e.jsx(I,{to:"/app/stats",children:"Statistics"}),e.jsx(I,{to:"/app/upload",children:"Upload images"}),e.jsx(I,{to:"/app/search",children:"Search via image"})]})]})}const W="_half_1m39z_1",G="_previewImg_1m39z_29",V="_container_1m39z_37",K="_customUpload_1m39z_57",Y="_whole_1m39z_85",l={half:W,previewImg:G,container:V,customUpload:K,whole:Y};function J(){const[i,o]=a.useState(null),[m,c]=a.useState(null),[s,t]=a.useState([]),[n,_]=a.useState(null),[f,b]=a.useState(!0),[d,j]=a.useState(!1),[h,k]=a.useState(""),N=u=>{k(u.target.value)},D=u=>{j(!d),d||k("")},w=u=>{const r=Array.from(u.target.files),x=URL.createObjectURL(r[0]);o(x),c(r[0])},O=async u=>{u.preventDefault();const r=new FormData;r.append("image",m),r.append("label",h);const x=window.location.pathname,L=x.endsWith("/search")?"http://127.0.0.1:8000/api/search/":x.endsWith("/upload")?"http://127.0.0.1:8000/api/upload/":"";console.log(x),console.log(r);try{const y=await(await fetch(L,{method:"POST",body:r})).json();x.endsWith("/upload")&&t(y.mask_urls),_(y),console.log("data ",y),console.log("maskUrls ",s),b(!1)}catch(S){console.error("Failed to send/fetch to upload api ",S)}};return e.jsx("form",{onSubmit:O,children:e.jsxs("div",{className:l.container,children:[e.jsxs("label",{className:l.customUpload,children:[i?e.jsx("img",{src:i,alt:"Preview"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{style:l.icon,children:"☁️"}),e.jsx("div",{style:l.labelText,children:"Upload an image"})]}),e.jsx("input",{type:"file",accept:"image/*",id:"file-input",name:"filename",onChange:w})]}),e.jsxs("div",{className:l.BandCheck,children:[e.jsx("label",{for:"toggle_label",children:"Do you know the bands for this bird?"}),e.jsx("input",{type:"checkbox",name:"toggle_label",onChange:D}),d?e.jsxs(e.Fragment,{children:[e.jsx("label",{for:"b_label",children:"Band code:"}),e.jsx("input",{type:"text",id:"b_label",name:"b_label",onChange:N})]}):e.jsx(e.Fragment,{})," "]}),f?e.jsx("p",{}):s===void 0||s.length==0?n===void 0?e.jsx("p",{children:"Loading bird prediction..."}):n[0].new_bird_flag==!1?e.jsxs("p",{children:["I think this bird may be ",n[0].winner,"!"," ",n[0].count," of the image vector's nearest neighbors had this label. The median distance of its k-neighbors was greater than 0.8 using cosine similarity, suggesting this image represents a known bird."]}):e.jsxs("p",{children:["I think this may be a new bird... ",n[0].count," of the image vector's nearest neighbors had the label"," ",n[0].winner,". The median distance of its k-neighbors was greater than 0.8, suggesting this is a bird I haven't seen before."]}):e.jsx(e.Fragment,{children:s.map((u,r)=>e.jsx("img",{src:u,alt:`mask-${r}`},r))}),e.jsx("img",{className:l.previewImg}),e.jsx("input",{type:"submit"})]})})}const Q="_indivPost_wqkgm_1",X="_dashboard_wqkgm_19",Z="_postContent_wqkgm_31",ee="_postImg_wqkgm_41",se="_postHeader_wqkgm_51",v={indivPost:Q,dashboard:X,postContent:Z,postImg:ee,postHeader:se};function te(){const[i,o]=a.useState(null),[m,c]=a.useState(null),[s,t]=a.useState([]),[n,_]=a.useState(!0),[f,b]=a.useState(!1),[d,j]=a.useState(""),[h,k]=a.useState(null),[N,D]=a.useState(5),[w,O]=a.useState("DINO");console.log("CAN ANYONE HEAR ME");const u=p=>{j(p.target.value)},r=p=>{D(parseInt(p.target.value))},x=p=>{O(p.target.value)},L=p=>{b(!f),f||j("")},S=p=>{const g=Array.from(p.target.files),C=URL.createObjectURL(g[0]);o(C),c(g[0])},y=async p=>{p.preventDefault();const g=new FormData;g.append("image",m),g.append("label",d),g.append("model",w),g.append("k_nn",N),console.log("model is stored as ",w),console.log(g);try{const T=await(await fetch("http://127.0.0.1:8000/api/search/",{method:"POST",body:g})).json();k(T),console.log("GetData",h),_(!1)}catch(C){console.error("Failed to send/fetch to upload api ",C)}};return e.jsx("form",{onSubmit:y,children:e.jsxs("div",{className:l.container,children:[e.jsxs("label",{className:l.customUpload,children:[i?e.jsx("img",{src:i,alt:"Preview"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{style:l.icon,children:"☁️"}),e.jsx("div",{style:l.labelText,children:"Upload an image"})]}),e.jsx("input",{type:"file",accept:"image/*",id:"file-input",name:"filename",onChange:S})]}),e.jsxs("div",{className:l.BandCheck,children:[e.jsx("label",{for:"toggle_label",children:"Do you know the bands for this bird?"}),e.jsx("input",{type:"checkbox",name:"toggle_label",onChange:L}),f?e.jsxs(e.Fragment,{children:[e.jsx("label",{for:"b_label",children:"Band code:"}),e.jsx("input",{type:"text",id:"b_label",name:"b_label",onChange:u})]}):e.jsx(e.Fragment,{})," "]}),e.jsxs("div",{children:[e.jsx("label",{children:"Which model would you like to test?: "}),e.jsxs("select",{name:"model",id:"model",value:w,onChange:x,children:[e.jsx("option",{value:"DINO",children:"DINOv2"}),e.jsx("option",{value:"CNN",children:"CNN"})]})]}),e.jsxs("div",{children:[e.jsx("label",{children:"K-NN for image search: "}),e.jsxs("select",{name:"k-nn",id:"k-nn",value:N,onChange:r,children:[e.jsx("option",{value:"2",children:"2"}),e.jsx("option",{value:"3",children:"3"}),e.jsx("option",{value:"4",children:"4"}),e.jsx("option",{value:"5",children:"5"}),e.jsx("option",{value:"7",children:"7"}),e.jsx("option",{value:"9",children:"9"}),e.jsx("option",{value:"10",children:"10"}),e.jsx("option",{value:"12",children:"12"}),e.jsx("option",{value:"15",children:"15"}),e.jsx("option",{value:"18",children:"18"}),e.jsx("option",{value:"24",children:"24"}),e.jsx("option",{value:"42",children:"42"})]})]}),n?e.jsx("p",{}):s===void 0||s.length==0?h===void 0?e.jsx("p",{children:"Loading bird prediction..."}):h.success===0?e.jsx("p",{children:"Oops! The YOLO model can't see a kaakaa in your image. Are you sure this is an image of a kaakaa?"}):h[0].new_bird_flag==!1?e.jsxs("p",{children:["I think this bird may be ",h[0].winner,"!"," ",h[0].count," of the image vector's nearest neighbors had this label. The median distance of its k-neighbors was greater than 0.8 using cosine similarity, suggesting this image represents a known bird."]}):e.jsxs("p",{children:["I think this may be a new bird... ",h[0].count," of the image vector's nearest neighbors had the label"," ",h[0].winner,". The median distance of its k-neighbors was greater than 0.8, suggesting this is a bird I haven't seen before."]}):e.jsx(e.Fragment,{}),e.jsx("img",{className:l.previewImg}),e.jsx("input",{type:"submit"})]})})}function ae(){const i=window.location.pathname.endsWith("/search")?"search":window.location.pathname.endsWith("/upload")?"upload":"";return e.jsxs("div",{className:l.half,children:[e.jsx("div",{className:v.postHeader,children:"Upload section"}),i=="upload"?e.jsx(J,{}):e.jsx(te,{})]})}function F(){return e.jsx("div",{className:l.whole,children:e.jsx(ae,{})})}function ne({key:i,post:o}){Math.floor((Date.now()-o.date)/1e3);const[m,c]=a.useState(o.original);function s(t){const n=t-Date.now(),_=Math.floor(Math.abs(n)/1e3),f=[{label:"year",seconds:31536e3},{label:"month",seconds:2592e3},{label:"day",seconds:86400},{label:"hour",seconds:3600},{label:"minute",seconds:60},{label:"second",seconds:1}];for(const b of f){const d=Math.floor(_/b.seconds);if(d>=1){const j=b.label+(d>1?"s":"");return n<0?`${d} ${j} ago`:`in ${d} ${j}`}}return"just now"}return e.jsxs("div",{className:v.indivPost,children:[e.jsxs("div",{className:v.postHeader,children:["Uploaded ",s(o.date)]}),e.jsxs("div",{className:v.postContent,children:[e.jsx("button",{onClick:()=>c(o.original),children:"Original"}),o.masks.map((t,n)=>e.jsxs("button",{onClick:()=>c(t),children:["Mask ",n]})),e.jsx("img",{className:v.postImg,src:m})]})]})}function oe(){const[i,o]=a.useState([]),[m,c]=a.useState(!0);return a.useEffect(()=>{async function s(){try{const t=await fetch("http://127.0.0.1:8000/api/images-library");if(!t.ok)throw new Error("Failed to fetch posts");const n=await t.json();o(n)}catch(t){console.error(t)}finally{c(!1)}}s()},[]),m?e.jsx(e.Fragment,{}):e.jsx("div",{className:v.dashboard,children:i.map((s,t)=>e.jsx(ne,{post:s},t))})}const ie="_defaultPage_qrynq_1",le={defaultPage:ie};function re({children:i}){return e.jsx("div",{className:le.defaultPage,children:i})}function ce(){return e.jsx(re,{children:"SSTATS lol. lmao even"})}function de(){const[i,o]=a.useState(0);return console.log("Can literally any change be seen at all"),e.jsxs(B,{children:[e.jsx(z,{}),e.jsxs(M,{children:[e.jsx(U,{path:"*",element:e.jsx(oe,{})}),e.jsx(U,{path:"app/upload",element:e.jsx(F,{})}),e.jsx(U,{path:"app/search",element:e.jsx(F,{})}),e.jsx(U,{path:"app/stats",element:e.jsx(ce,{})})]})]})}A.createRoot(document.getElementById("root")).render(e.jsx(a.StrictMode,{children:e.jsx(de,{})}));
